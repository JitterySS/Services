# MADE BY CHATGPT
# Clean console-based Windows service checker

Write-Host "Starting service check..." -ForegroundColor Cyan

$services = @(
    "SysMain",
    "CDPUserSvc",
    "PcaSvc",
    "DPS",
    "EventLog",
    "Schedule",    # Task Scheduler
    "WSearch",     # SearchIndexer
    "Bam",
    "Dam",
    "DusmSvc",
    "Appinfo"
)

$results = @()

foreach ($svc in $services) {
    Write-Host "Checking service pattern: $svc*" -ForegroundColor Yellow
    $matchedServices = Get-WmiObject Win32_Service | Where-Object { $_.Name -like "$svc*" }

    if ($matchedServices) {
        foreach ($service in $matchedServices) {
            # Status: Running / Stopped
            $status = $service.State
            # StartupType: Auto / Manual / Disabled
            $startup = $service.StartMode
            # CreationDate may be null if service not running
            $startedAt = if ($status -eq "Running") { 
                try { [Management.ManagementDateTimeConverter]::ToDateTime($service.CreationDate) } 
                catch { "N/A" } 
            } else { "N/A" }

            $results += [PSCustomObject]@{
                Service     = $service.Name
                DisplayName = $service.DisplayName
                Status      = $status
                StartupType = $startup
                StartedAt   = $startedAt
            }
        }
    } else {
        $results += [PSCustomObject]@{
            Service     = $svc
            DisplayName = "Not Found"
            Status      = "N/A"
            StartupType = "N/A"
            StartedAt   = "N/A"
        }
    }
}

# Output table with color-coded status
Write-Host "`n===== Windows Service Report =====`n" -ForegroundColor Green

foreach ($r in $results) {
    $color = switch ($r.Status) {
        "Running" { "Green" }
        "Stopped" { "Red" }
        default   { "Yellow" }
    }
    Write-Host ("{0,-25} {1,-40} {2,-10} {3,-10} {4}" -f $r.Service, $r.DisplayName, $r.Status, $r.StartupType, $r.StartedAt) -ForegroundColor $color
}

Write-Host "`nService check complete!" -ForegroundColor Cyan
