# MADE BY CHATGPT
# Script to check status, startup type, and start time of specific Windows services

Write-Host "Starting service check..." -ForegroundColor Cyan

$services = @(
    "SysMain",
    "CDPUserSvc",
    "PcaSvc",
    "DPS",
    "EventLog",
    "Schedule",    # Task Scheduler
    "WSearch",     # SearchIndexer
    "Bam",
    "Dam",
    "DusmSvc",
    "Appinfo"
)

$results = foreach ($svc in $services) {
    Write-Host "Checking service: $svc" -ForegroundColor Yellow
    $matchedServices = Get-Service | Where-Object { $_.Name -like "$svc*" }

    if ($matchedServices) {
        foreach ($service in $matchedServices) {
            # Get startup type safely
            $config = Get-WmiObject Win32_Service -Filter "Name='$($service.Name)'" | Select-Object -ExpandProperty StartMode

            # Get start time safely
            try {
                $startTime = (Get-Process -Id $service.Id -ErrorAction Stop).StartTime.ToString("yyyy-MM-dd HH:mm:ss")
            } catch {
                $startTime = "N/A"
            }

            [PSCustomObject]@{
                Service     = $service.Name
                DisplayName = $service.DisplayName
                Status      = $service.Status
                StartupType = $config
                StartedAt   = $startTime
            }
        }
    } else {
        [PSCustomObject]@{
            Service     = $svc
            DisplayName = "Not Found"
            Status      = "N/A"
            StartupType = "N/A"
            StartedAt   = "N/A"
        }
    }
}

# Output table cleanly in console
Write-Host "`n===== Service Status Report =====`n" -ForegroundColor Green
$results | Format-Table -AutoSize
Write-Host "`nDone!" -ForegroundColor Cyan
